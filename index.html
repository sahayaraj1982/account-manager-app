<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOOD DAY E-BOOK V60 FINAL</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root { --dr: #ff1744; --cr: #00e676; --gold: #ffd700; }
        * { font-weight: 900 !important; font-family: 'Arial Black', sans-serif; box-sizing: border-box; }
        body { margin: 0; background: #000; padding: 5px; display: flex; justify-content: center; overflow: hidden; height: 100vh; }
        /* ‡ÆÖ‡Æï‡Æ≥‡ÆÆ‡Øç 1 ‡Æá‡Æ©‡Øç‡Æö‡Øç ‡ÆÖ‡Æ≥‡Æµ‡ØÅ ‡ÆÖ‡Æ§‡Æø‡Æï‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ */
        .app-container { width: 100%; max-width: 1050px; display: flex; flex-direction: column; height: 100%; }
        .box { border: 3px solid #fff; border-radius: 12px; margin-bottom: 8px; padding: 8px; position: relative; }
        .box-1 { background: linear-gradient(135deg, #6200ea, #ff0055); flex-shrink: 0; }
        .box-2 { background: linear-gradient(135deg, #1a237e, #0288d1); flex-shrink: 0; }
        .box-3 { background: linear-gradient(135deg, #1b5e20, #43a047); flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; }
        /* ‡Æü‡Øà‡Æ™‡Øç‡Æ™‡Æø‡Æô‡Øç ‡Æé‡Æ¥‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ØÜ‡Æ∞‡Æø‡Æ§‡Ææ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ */
        input, select { padding: 10px; border: 2px solid #000; border-radius: 8px; font-size: 16px !important; width: 100%; background: #fff; }
        .row { display: flex; gap: 8px; margin-bottom: 6px; flex-wrap: wrap; }
        .btn { padding: 12px 0; border: 2px solid #000; border-radius: 10px; color: white; text-align: center; cursor: pointer; flex: 1; font-size: 15px; text-shadow: 1px 1px #000; }
        .save-btn { background: var(--gold); color: #000; text-shadow: none; font-size: 16px; border: 3px solid #000; }
        .list-wrap { background: #fff; border: 2px solid #000; border-radius: 10px; flex-grow: 1; overflow: hidden; display: flex; flex-direction: column; margin-top: 5px; }
        .t-head { display: grid; grid-template-columns: 1fr 1.5fr 1fr 2fr 1fr; background: #000; color: #fff; text-align: center; font-size: 12px; padding: 10px 0; flex-shrink: 0; }
        /* ‡Æ≤‡Æø‡Æ∏‡Øç‡Æü‡Øç ‡Æµ‡Æø‡Æµ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ØÜ‡Æ∞‡Æø‡Æ§‡Ææ‡Æï‡Æ§‡Øç ‡Æ§‡ØÜ‡Æ∞‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Øç */
        .t-row { display: grid; grid-template-columns: 1fr 1.5fr 1fr 2fr 1fr; border-bottom: 1px solid #ddd; text-align: center; font-size: 15px; background: #fff; color: #000; }
        .t-row > div { padding: 12px 4px; border-right: 1px solid #eee; display: flex; align-items: center; justify-content: center; word-break: break-all; }
        .label { color: #fff; font-size: 11px; margin-bottom: 2px; display: block; text-shadow: 1px 1px #000; }
        #list-scroll { overflow-y: auto; flex-grow: 1; }
    </style>
</head>
<body>
<div class="app-container">
    <div class="box box-1">
        <div style="text-align: center; color: #fff; font-size: 22px; text-shadow: 2px 2px 0px #000;">GOOD DAY E-BOOK</div>
        <div style="display: flex; justify-content: space-between; margin-top: 5px; border-top: 1px solid rgba(255,255,255,0.3); padding-top: 4px; align-items: center;">
            <div style="color: var(--gold); font-size: 16px;">COUNT: <span id="cnt">0</span></div>
            <div style="color: #fff; font-size: 16px;"><span id="month-label">TOTAL</span>: ‚Çπ <span id="tot">0</span></div>
            <div style="display: flex; gap: 5px;">
                <div onclick="exportData()" style="background:#fff; color:#000; padding:2px 8px; border-radius:6px; font-size:11px; cursor:pointer; border: 1px solid #000;">EXPORT</div>
                <label style="background:#fff; color:#000; padding:2px 8px; border-radius:6px; font-size:11px; cursor:pointer; border: 1px solid #000;">IMPORT<input type="file" id="impFile" hidden onchange="importData()"></label>
                <div onclick="downloadPDF()" style="background:var(--gold); color:#000; padding:2px 8px; border-radius:6px; font-size:11px; cursor:pointer; border: 1px solid #000;">PDF</div>
            </div>
        </div>
    </div>
    <div class="box box-2">
        <div class="row">
            <div style="flex:1"><span class="label">DATE</span><input type="date" id="d-in"></div>
            <div style="flex:1.2"><span class="label">MOBILE</span><input type="tel" id="m-in" placeholder="No"></div>
            <div style="flex:1"><span class="label">CAT</span><select id="c-in"><option value="TICKET">TICKET</option><option value="FINANCE">FINANCE</option><option value="RO">RO</option></select></div>
            <div style="flex:2"><span class="label">DESCRIPTION</span><input type="text" id="ds-in" placeholder="Type details here..."></div>
            <div style="flex:1"><span class="label">AMOUNT</span><input type="number" id="a-in" placeholder="‚Çπ"></div>
        </div>
        <div class="row" style="margin-bottom: 0;">
            <div id="dr" onclick="setT('DR')" class="btn" style="background:var(--dr); opacity:0.5;">DEBIT</div>
            <div id="cr" onclick="setT('CR')" class="btn" style="background:var(--cr); opacity:0.5;">CREDIT</div>
            <div onclick="save()" class="btn save-btn">SAVE ‚úÖ</div>
        </div>
    </div>
    <div class="box box-3">
        <div class="row" style="align-items: flex-end;">
            <div style="flex:1"><span class="label">FROM</span><input type="date" id="sd"></div>
            <div style="flex:1"><span class="label">TO</span><input type="date" id="ed"></div>
            <div style="flex:1.2"><input type="tel" id="sm" placeholder="Search Mobile" style="font-size: 14px !important;"></div>
            <div style="flex:1"><select id="sc" style="font-size: 14px !important;"><option value="">All Category</option><option value="TICKET">TICKET</option><option value="FINANCE">FINANCE</option><option value="RO">RO</option></select></div>
            <button onclick="draw(true)" style="flex:0.3; background:#000; color:#fff; border:1px solid #fff; border-radius:8px; padding: 10px; cursor:pointer;">üîç</button>
        </div>
        <div class="list-wrap">
            <div class="t-head"><div>DATE</div><div>MOBILE</div><div>CAT</div><div>DESC</div><div>AMT</div></div>
            <div id="list-scroll"><div id="list"></div></div>
        </div>
    </div>
</div>
<script>
    /* ‡Æ™‡Æ¥‡Øà‡ÆØ V55 ‡Æü‡Øá‡Æü‡Øç‡Æü‡Ææ‡Æµ‡Øà ‡Æá‡Æ¥‡ØÅ‡Æï‡Øç‡Æï dbName ‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ±‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡ØÅ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ */
    let dbName = 'GD_FINAL_V55'; 
    let db = JSON.parse(localStorage.getItem(dbName)) || [];
    let cur = '';
    document.getElementById('d-in').value = new Date().toISOString().split('T')[0];
    function setT(t) { cur = t; document.getElementById('dr').style.opacity = (t==='DR'?'1':'0.5'); document.getElementById('cr').style.opacity = (t==='CR'?'1':'0.5'); }
    function save() {
        const a = document.getElementById('a-in').value;
        if(!a || !cur) { alert("Select DEBIT/CREDIT & Amount!"); return; }
        db.push({ id: Date.now(), d: document.getElementById('d-in').value, m: document.getElementById('m-in').value || '-', c: document.getElementById('c-in').value, ds: document.getElementById('ds-in').value || '-', a: parseFloat(a), t: cur });
        db.sort((a, b) => new Date(b.d) - new Date(a.d));
        localStorage.setItem(dbName, JSON.stringify(db));
        draw(); reset();
    }
    function draw(isSearch = false) {
        const box = document.getElementById('list');
        const s = document.getElementById('sd').value, e = document.getElementById('ed').value;
        const m = document.getElementById('sm').value, c = document.getElementById('sc').value;
        box.innerHTML = '';
        let f = db.filter(i => ((!s || i.d >= s) && (!e || i.d <= e)) && (!m || i.m.includes(m)) && (!c || i.c === c));
        let total = 0;
        if(isSearch && (s || e || m || c)) {
            document.getElementById('month-label').innerText = "FILTER TOTAL";
            total = f.reduce((sum, i) => sum + (i.t === 'CR' ? i.a : -i.a), 0);
        } else if (db.length > 0) {
            let lastDate = new Date(db[0].d);
            let monthNames = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
            document.getElementById('month-label').innerText = monthNames[lastDate.getMonth()] + " TOTAL";
            total = db.filter(i => new Date(i.d).getMonth() === lastDate.getMonth() && new Date(i.d).getFullYear() === lastDate.getFullYear()).reduce((sum, i) => sum + (i.t === 'CR' ? i.a : -i.a), 0);
        }
        document.getElementById('tot').innerText = total.toLocaleString();
        document.getElementById('cnt').innerText = f.length;
        f.forEach(i => {
            const r = document.createElement('div');
            r.className = 't-row';
            r.innerHTML = `<div>${i.d.split('-').reverse().join('-').substring(0,5)}</div><div>${i.m}</div><div>${i.c}</div><div style="font-size:13px">${i.ds}</div><div style="color:${i.t==='CR'?'#00c853':'#ff1744'}; font-weight:bold;">${i.a}</div>`;
            r.onclick = () => { if(confirm("Delete?")) { db = db.filter(x=>x.id!==i.id); localStorage.setItem(dbName,JSON.stringify(db)); draw(); } };
            box.appendChild(r);
        });
    }
    function reset() { document.getElementById('a-in').value=''; document.getElementById('ds-in').value=''; document.getElementById('m-in').value=''; cur=''; document.getElementById('dr').style.opacity='0.5'; document.getElementById('cr').style.opacity='0.5'; }
    function exportData() {
        const data = JSON.stringify(db);
        const blob = new Blob([data], {type: "application/json"});
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "GoodDay_Backup_" + new Date().toLocaleDateString() + ".json";
        a.click();
    }
    function importData() {
        const file = document.getElementById("impFile").files[0];
        const reader = new FileReader();
        reader.onload = function(e) {
            try {
                const imported = JSON.parse(e.target.result);
                if(confirm("Import " + imported.length + " entries?")) {
                    db = imported;
                    localStorage.setItem(dbName, JSON.stringify(db));
                    draw();
                    alert("Data Restored!");
                }
            } catch(err) { alert("Invalid Backup File!"); }
        };
        reader.readAsText(file);
    }
    function downloadPDF() { const { jsPDF } = window.jspdf; const doc = new jsPDF(); doc.autoTable({ head:[['Date', 'Mobile', 'Cat', 'Description', 'Amount']], body: db.map(e=>[e.d, e.m, e.c, e.ds, (e.t==='CR'?'+':'-')+e.a]), theme: 'grid' }); doc.save("Report.pdf"); }
    window.onload = () => { db.sort((a, b) => new Date(b.d) - new Date(a.d)); draw(); };
</script>
</body>
</html>
